<div id="policies-content" class="tab-pane">
    <div class="panel panel-default">
        <div class="panel-heading panel-heading-flex">
            <strong>Policies for Alyson Gross</strong>
            <div class="btn-group btn-group-responsive">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newPolicyModal">
                    <span class="btn-text">Create new</span>
                </button>
                <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-angle-down"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-right">
                    <li><a href="{% url 'agent_column_settings' %}">Column Setting</a></li>
                    <li><a href="#">Download CSV</a></li>
                </ul>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <input type="text" id="contracts-search" class="form-control" placeholder="Search: Type to filter (Individual Name, Type, Status)">
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 text-right">
                        <div class="form-inline">
                            <div class="form-group">
                                <label>Show 
                                    <select id="contracts-length" class="form-control input-sm">
                                        <option>25</option>
                                        <option>50</option>
                                        <option>100</option>
                                    </select> 
                                    entries
                                </label>
                            </div>
                        </div>
                    </div>
        
        <div class="panel-body">
            <div class="table-responsive-wrapper">
                <table id="policiesTable" class="table display responsive nowrap" style="width:100%">
                    <thead>
                        <tr>
                            <th>Policy Number</th>
                            <th>Holder Name</th>
                            <th>Effective Date</th>
                            <th>Renewal Date</th>
                            <th>Status</th>
                            <th>Carrier</th>
                            <th>Coverage Type</th>
                            <th>Carrier Product</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><a href="#">POL123456</a></td>
                            <td>John Doe</td>
                            <td>2023-01-15</td>
                            <td>2024-01-15</td>
                            <td><span class="label label-success">Active</span></td>
                            <td>ABC Insurance</td>
                            <td>Health</td>
                            <td>Gold Plan</td>
                        </tr>
                        <tr>
                            <td><a href="#">POL789012</a></td>
                            <td>Jane Smith</td>
                            <td>2023-03-20</td>
                            <td>2024-03-20</td>
                            <td><span class="label label-warning">Pending</span></td>
                            <td>XYZ Insurance</td>
                            <td>Life</td>
                            <td>Silver Plan</td>
                        </tr>
                        <tr>
                            <td><a href="#">POL345678</a></td>
                            <td>Robert Brown</td>
                            <td>2022-11-05</td>
                            <td>2023-11-05</td>
                            <td><span class="label label-danger">Lapsed</span></td>
                            <td>DEF Insurance</td>
                            <td>Auto</td>
                            <td>Platinum Plan</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- New Policy Modal -->
<div class="modal fade" id="newPolicyModal" tabindex="-1" role="dialog" aria-labelledby="newPolicyModalLabel">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title" id="newPolicyModalLabel">New Policy</h4>
            </div>
            
            <div class="modal-body">
                <form id="policyForm">
                    <div class="step-container">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <div class="step-indicator">
                                    <span class="step-number">1</span>
                                    <span class="step-title">Client Info</span>
                                </div>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label for="recordType">Select Record Type</label>
                                    <select id="recordType" class="form-control" required>
                                        <option value="">-- Select --</option>
                                        <option>Existing Individual</option>
                                        <option>New Individual</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="individualName">Individual Name <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="individualName" placeholder="Type to search" required>
                                </div>
                            </div>
                        </div>

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <div class="step-indicator">
                                    <span class="step-number">2</span>
                                    <span class="step-title">Policy Info</span>
                                </div>
                            </div>
                            <div class="panel-body">
                                <p>Fields marked with an <span class="text-danger">*</span> are required.</p>
                                <div class="form-group">
                                    <label for="policyType">Policy Type <span class="text-danger">*</span></label>
                                    <select id="policyType" class="form-control" required>
                                        <option value="">-- Select --</option>
                                        <option>Health</option>
                                        <option>Life</option>
                                        <option>Auto</option>
                                        <option>Home</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="effectiveDate">Effective Date <span class="text-danger">*</span></label>
                                    <input type="date" class="form-control" id="effectiveDate" required>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button type="submit" class="btn btn-success" form="policyForm">Save</button>
                <button type="submit" class="btn btn-success" form="policyForm">Save & Add Coverage</button>
                <button type="submit" class="btn btn-success" form="policyForm">Save & Add Another</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            </div>
        </div>
            </div>
        </div>

<style>
    /* Panel heading with flex layout */
    .panel-heading-flex {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        padding: 10px 15px;
    }
    
    /* Responsive button group */
    .btn-group-responsive {
        display: flex;
        flex-wrap: nowrap;
        margin-top: 10px;
    }
    
   
    .btn-text {
        display: inline;
    }
    
    /* Table responsive container */
    .table-responsive-wrapper {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    /* Status labels */
    .label {
        display: inline-block;
        padding: 3px 6px;
        font-size: 12px;
        font-weight: bold;
        border-radius: 3px;
    }
    .label-success { background-color: #5cb85c; color: white; }
    .label-warning { background-color: #f0ad4e; color: white; }
    .label-danger { background-color: #d9534f; color: white; }
    
    /* Modal footer adjustments */
    .modal-footer-responsive {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }
    
    /* Step indicator styling */
    .step-indicator {
        display: flex;
        align-items: center;
    }
    .step-number {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
        background-color: #07408b;
        color: white;
        border-radius: 50%;
        font-weight: bold;
        margin-right: 10px;
    }
    
    /* Responsive adjustments */
    @media (max-width: 767px) {
        .panel-heading-flex {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .btn-group-responsive {
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-text {
            display: none;
        }
        
        .btn-group-responsive > .btn:first-child {
            flex-grow: 1;
            text-align: left;
            padding-left: 10px;
        }
        
        .btn-group-responsive > .btn:first-child::after {
            content: "New";
        }
        
        .modal-footer-responsive {
            flex-direction: column-reverse;
            gap: 10px;
        }
        
        .modal-footer-responsive .btn-group {
            width: 100%;
        }
        
        .modal-footer-responsive .btn-default {
            width: 100%;
        }
        
        table.dataTable thead > tr > th {
            padding-right: 30px; 
        }
    }
    
    @media (max-width: 480px) {
        .step-indicator {
            font-size: 14px;
        }
        
        .step-number {
            width: 20px;
            height: 20px;
            font-size: 12px;
        }
        
        .modal-body .form-group {
            margin-bottom: 10px;
        }
    }
</style>

<script>
$(document).ready(function() {
    // Initialize DataTable with responsive settings
    $('#policiesTable').DataTable({
        responsive: {
            details: {
                display: $.fn.dataTable.Responsive.display.modal({
                    header: function(row) {
                        return 'Policy Details';
                    }
                }),
                renderer: $.fn.dataTable.Responsive.renderer.tableAll({
                    tableClass: 'table'
                })
            }
        },
        dom: "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
             "<'row'<'col-sm-12'tr>>" +
             "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        language: {
            search: "_INPUT_",
            searchPlaceholder: "Search policies...",
            lengthMenu: "_MENU_ records per page",
            paginate: {
                previous: "<",
                next: ">"
            }
        },
        columnDefs: [
            { responsivePriority: 1, targets: 0 }, // Policy Number
            { responsivePriority: 2, targets: 1 }, // Holder Name
            { responsivePriority: 3, targets: 4 }, // Status
            { responsivePriority: 4, targets: 2 }  // Effective Date
        ]
    });

    // Form submission handler for policy form
    $('#policyForm').on('submit', function(e) {
        e.preventDefault();
        // Add your form submission logic here
        $('#newPolicyModal').modal('hide');
        alert('Policy saved successfully!');
        this.reset();
    });
    
    // Adjust table on window resize
    $(window).on('resize', function() {
        $('#policiesTable').DataTable().responsive.recalc();
    });
});
</script>